!function(){"undefined"==typeof Election&&(window.Election={}),Election.DIM_X=622,Election.DIM_Y=481,Election.FPS=60,Election.NUM_BILLS=50,Election.NUM_PAPERS=80,Election.MOVES={left:[-1,0],right:[1,0]},Election.WINNING_SCORE=30}(),window.onkeydown=function(a){return!(32==a.keyCode)},function(){"undefined"==typeof Election&&(window.Election={}),Election.Util={},Election.Util.createBlankScreen=function(){ctx.fillStyle="#000000",ctx.fillRect(0,0,Election.DIM_X,Election.DIM_Y)},Election.Util.distanceMagnitude=function(a,b){return Math.sqrt(Math.pow(b[0]-a[0],2)+Math.pow(b[1]-a[1],2))},Election.Util.inherits=function(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c},Election.Util.renderText=function(a,b){ctx.font="20px serif",ctx.textAlign="left",ctx.fillStyle="#E0E0E0",a.forEach(function(a){ctx.fillText(a,100,b),b+=50})}}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.FallingObject=function(a){this.img=a.img,this.width=a.width,this.height=a.height,this.x=Math.floor(Math.random()*(Election.DIM_X-this.width)),this.y=0,this.center=[this.x+this.width/2,this.y+this.height/2],this.XVELDIVISOR=120,this.setXVelocity(),this.yVel=1,this.yAccel=.18};a.prototype.isFallen=function(){return this.y>=Election.DIM_Y},a.prototype.render=function(){ctx.drawImage(this.img,this.x,this.y,this.width,this.height)},a.prototype.setXVelocity=function(){var a=[this.x,Election.DIM_X-this.x].sort()[0];this.xVel=(2*Math.random()-1)*a/this.XVELDIVISOR},a.prototype.update=function(){this.x+=this.xVel,this.y+=this.yVel,this.center=[this.x+this.width/2,this.y+this.height/2],this.yVel+=this.yAccel}}(),function(){"undefined"==typeof Election&&(window.Election={}),Election.HandController={run:function(a,b){var c={};document.onkeydown=function(d){var e=(d||window.event).keyCode;return e in a?(e in c||(c[e]=null,a[e](),0!==b&&(c[e]=setInterval(a[e],b))),!1):!0},document.onkeyup=function(a){var b=(a||window.event).keyCode;b in c&&(null!==c[b]&&clearInterval(c[b]),delete c[b])},window.onblur=function(){for(key in c)null!==c[key]&&clearInterval(c[key]);c={}}}};var a=Election.Hand=function(a){this.img=a,this.width=70,this.height=70,this.x=Math.floor((Election.DIM_X-this.width)/2),this.y=Election.DIM_Y-this.height,this.center=[this.x+this.width/2,this.y+this.height/2]};a.prototype.handleInput=function(a){"left"===a&&this.x>=0?this.x-=6:"right"===a&&this.x<=Election.DIM_X-this.width&&(this.x+=6),this.center=[this.x+this.width/2,this.y+this.height/2]},a.prototype.isCollidedWith=function(a){return Election.Util.distanceMagnitude(this.center,a.center)<(this.width+a.width)/2},a.prototype.render=function(){ctx.drawImage(this.img,this.x,this.y,this.width,this.height)}}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.Bill=function(a){a.height=60,a.width=30,Election.FallingObject.call(this,a)};Election.Util.inherits(a,Election.FallingObject)}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.Newspaper=function(a){a.height=80,a.width=80,Election.FallingObject.call(this,a)};Election.Util.inherits(a,Election.FallingObject)}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.StartView=function(a){this.game=a,this.renderCallbacks=[this.renderDirections,this.renderControls,this.game.runGameplay.bind(this.game)]};a.prototype.handleInput=function(){this.renderCallbacks.shift()},a.prototype.render=function(){ctx.clearRect(0,0,Election.DIM_X,Election.DIM_Y),this.renderCallbacks[0].call()},a.prototype.renderControls=function(){var a="Use the <- and -> arrow keys to control\n",b="the hand at the bottom of the screen.\n",c="Watch out for the press!",d="Press any key to begin.";Election.Util.createBlankScreen(),Election.Util.renderText([a,b,c,d],Election.DIM_Y/2-100)},a.prototype.renderDirections=function(){var a="You're running for US President in 2016!\n",b="Raise at least $30 million in campaign\n",c="contributions in order to win.\n",d="Press any key to see the controls.";Election.Util.createBlankScreen(),Election.Util.renderText([a,b,c,d],Election.DIM_Y/2-100)}}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.GameView=function(a){this.game=a};a.prototype.render=function(){ctx.clearRect(0,0,Election.DIM_X,Election.DIM_Y),this.renderScore(),this.renderReputation(),this.game.allObjects().forEach(function(a){a.render()})},a.prototype.renderHowardDean=function(){ctxTop.drawImage(this.game.options.deanImg,320,20),setTimeout(function(){ctxTop.clearRect(320,20,120,120)},2e3)},a.prototype.renderScore=function(){var a="Campaign Fund";if(0===this.game.score)var b="Total: $"+this.game.score;else var b="Total: $"+this.game.score+",000,000";ctx.font="20px arial",ctx.textAlign="right",ctx.fillStyle="#000099",ctx.fillText(a,Election.DIM_X-20,50),ctx.fillText(b,Election.DIM_X-20,100)},a.prototype.renderReputation=function(){var a=this,b="REPUTATION",c=0;ctx.fillStyle="#000000",ctx.fillRect(130,45,106,30),this.game.pressPoints>2?(ctx.fillStyle="#009900",c=10*this.game.pressPoints):(ctx.fillStyle="#A00000",a.game.pressPoints>0&&(c=10*a.game.pressPoints)),ctx.fillRect(133,48,c,24),ctx.font="14px arial",ctx.textAlign="center",ctx.fillStyle="#FFFFFF",ctx.fillText(b,183,65)}}(),function(){"undefined"==typeof Election&&(window.Election={});var a=Election.FinishView=function(a){this.game=a};a.prototype.renderMoneyLoss=function(){var a="Looks like your campaign couldn't afford enough",b="advertising and travel to win the election. Next time,",c="focus more on fundraising, especially with wealthy donors.";Election.Util.renderText([a,b,c],300)},a.prototype.renderPressLoss=function(){var a="Oh no! You've committed a few too many gaffs and",b="made too many controversial comments to win this",c="election. Watch out for the press if you run again,",d="and try to be more consistent and conventional.";Election.Util.renderText([a,b,c,d],100)},a.prototype.renderWin=function(){var a="Congratulations! You gathered enough campaign",b="contributions and maintained a good reputation",c="in the press. You are now President of the",d="United States.";Election.Util.renderText([a,b,c,d],Election.DIM_Y/2-100)}}(),function(a){"undefined"==typeof Election&&(window.Election={});var b=function(a){a.keyCode&&this.startView.handleInput()},c=Election.Game=function(b){a.ctx=b.ctx,a.ctxTop=b.ctxTop,this.options=b,this.bills=[],this.papers=[],this.hand=new Election.Hand(b.handImg),this.gameView=new Election.GameView(this),this.startView=new Election.StartView(this),this.finishView=new Election.FinishView(this),this.pressPoints=10,this.score=0,this.billsCreated=0,this.papersCreated=0};c.prototype.addBill=function(){this.billsCreated<Election.NUM_BILLS&&(this.bills.push(new Election.Bill({img:this.options.billImg})),this.billsCreated+=1)},c.prototype.addNewspaper=function(){this.papersCreated<Election.NUM_PAPERS&&(this.papers.push(new Election.Newspaper({img:this.options.paperImg})),this.papersCreated+=1)},c.prototype.allObjects=function(){return[this.hand].concat(this.bills).concat(this.papers)},c.prototype.collideWithHand=function(a){a instanceof Election.Bill?(this.options.audioEl.src="audio/cha_ching_register.mp3",this.score+=1):a instanceof Election.Newspaper&&(this.options.audioEl.src="audio/dean_scream.mp3",this.pressPoints-=1,this.gameView.renderHowardDean()),this.options.audioEl.play(),this.remove(a)},c.prototype.fallingObjects=function(){return this.bills.concat(this.papers)},c.prototype.isMoneyLoss=function(){return this.score<Election.WINNING_SCORE},c.prototype.isOver=function(){return this.billsCreated===Election.NUM_BILLS&&this.papersCreated===Election.NUM_PAPERS},c.prototype.isPressLoss=function(){return this.pressPoints<1},c.prototype.isWon=function(){return this.score>=Election.WINNING_SCORE&&this.pressPoints>0},c.prototype.remove=function(a){a instanceof Election.Bill?this.bills.shift():a instanceof Election.Newspaper&&this.papers.shift()},c.prototype.runDirections=function(){document.addEventListener("keydown",b.bind(this)),this.timer4=setInterval(function(){this.startView.render()}.bind(this),1e3/Election.FPS)},c.prototype.runGameplay=function(){var a=this;this.stopDirections(),this.runHand(),setTimeout(a.runFallingObjects.bind(a),1500)},c.prototype.runHand=function(){var a=this;Election.HandController.run({37:function(){a.hand.handleInput("left")},39:function(){a.hand.handleInput("right")}},1e3/Election.FPS),this.timer1=setInterval(function(){a.update(),a.gameView.render(),a.isOver()&&(Election.Util.createBlankScreen(),a.options.musicEl.pause(),a.isWon()?(a.options.audioEl.src="audio/stars_and_stripes.mp3",a.finishView.renderWin()):(a.options.audioEl.src="audio/sad_trombone.mp3",a.isMoneyLoss()&&a.finishView.renderMoneyLoss(),a.isPressLoss()&&a.finishView.renderPressLoss()),a.stopGameplay())},1e3/Election.FPS)},c.prototype.runFallingObjects=function(){var a=this;this.timer2=setInterval(function(){a.addBill()},1e3),this.timer3=setInterval(function(){a.addNewspaper()},Election.NUM_BILLS/Election.NUM_PAPERS*1e3)},c.prototype.start=function(){this.runDirections(),this.options.musicEl.src="audio/politician.mp3",this.options.musicEl.play()},c.prototype.stopDirections=function(){document.removeEventListener("keydown",b.bind(this)),clearInterval(this.timer4)},c.prototype.stopGameplay=function(){this.options.audioEl.play(),clearInterval(this.timer1),clearInterval(this.timer2),clearInterval(this.timer3)},c.prototype.update=function(){var a=this;this.fallingObjects().slice(0).forEach(function(b){b.isFallen()?a.remove(b):a.hand.isCollidedWith(b)?a.collideWithHand(b):b.update()})}}(this),function(){var a=document.getElementsByTagName("canvas")[0],b=document.getElementsByTagName("canvas")[1],c=document.getElementsByTagName("audio")[0];musicEl=document.getElementsByTagName("audio")[1],[a,b].forEach(function(a){a.width=Election.DIM_X,a.height=Election.DIM_Y});var d=a.getContext("2d"),e=b.getContext("2d"),f=new Image,g=new Image,h=new Image,i=new Image,j=0,k=[f,g,h,i];g.src="images/million_dollar_bill.jpg",i.src="images/howard_dean.jpg",f.src="images/outstretched-hand.png",h.src="images/newspaper.png";var l=function(){if(j+=1,4===j){var a={ctx:d,handImg:f,billImg:g,paperImg:h,deanImg:i,audioEl:c,ctxTop:e,musicEl:musicEl},b=new Election.Game(a);b.start()}};k.forEach(function(a){a.addEventListener("load",l)})}();