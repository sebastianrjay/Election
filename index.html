<html>
  <head>
    <title>Election</title>
    <link rel="stylesheet" href="css/style.css">
  </head>

  <body>
    <audio></audio>
    <div style="position: relative;">
     <canvas id="layer1"
       style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
     <canvas id="layer2"
       style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
    </div>

    <script type="application/javascript" src="lib/util.js"></script>
    <script type="application/javascript" src="lib/fallingObject.js"></script>
    <script type="application/javascript" src="lib/hand.js"></script>
    <script type="application/javascript" src="lib/bill.js"></script>
    <script type="application/javascript" src="lib/newspaper.js"></script>
    <script type="application/javascript" src="lib/startView.js"></script>
    <script type="application/javascript" src="lib/gameView.js"></script>
    <script type="application/javascript" src="lib/finishView.js"></script>
    <script type="application/javascript" src="lib/game.js"></script>

    <script type="application/javascript">
      (function() {
        var canvasEl = document.getElementsByTagName("canvas")[0],
            topCanvasEl = document.getElementsByTagName("canvas")[1],
            audioEl = document.getElementsByTagName("audio")[0];
        canvasEl.width = Election.DIM_X;
        canvasEl.height = Election.DIM_Y;
        topCanvasEl.width = Election.DIM_X + 120;
        topCanvasEl.height = Election.DIM_Y;
        var ctx = canvasEl.getContext("2d"),
            ctxTop = topCanvasEl.getContext("2d"),
            handImg = new Image(),
            billImg = new Image(),
            paperImg = new Image(),
            deanImg = new Image(),
            imgsLoaded = 0;

        billImg.src = 'images/million_dollar_bill.jpg';
        deanImg.src = 'images/howard_dean.jpg';
        handImg.src = 'images/outstretched-hand.png';
        paperImg.src = 'images/newspaper.png';

        var imgLoadCallback = function(){
          imgsLoaded += 1;
          if(imgsLoaded === 4) {
            var options = {ctx: ctx, handImg: handImg, billImg: billImg,
              paperImg: paperImg, deanImg: deanImg, audioEl: audioEl,
                ctxTop: ctxTop
            }
            var game = new Election.Game(options);
            game.run();
          }
        };

        billImg.addEventListener("load", imgLoadCallback);
        deanImg.addEventListener("load", imgLoadCallback);
        handImg.addEventListener("load", imgLoadCallback);
        paperImg.addEventListener("load", imgLoadCallback);
      })();
    </script>
  </body>
</html>
